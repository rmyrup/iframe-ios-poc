<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">

  <meta http-equiv="cache-control" content="max-age=0"/>
  <meta http-equiv="cache-control" content="no-cache"/>
  <meta http-equiv="expires" content="0"/>
  <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
  <meta http-equiv="pragma" content="no-cache"/>

  <title>iframe-ios-poc | content</title>

  <style type="text/css">
    body, html {
      margin: 0;
      padding: 0;
      font-size: 12px;
    }

    body {
      overflow: hidden;
      background-color: #e39649;
      transition: background-color 1s ease;
    }

    section {
      margin: 2em;
    }

    pre {
      padding: 1em;
      background-color: #212121;
      color: #8ae300;
    }

    .theBigItem {
      width: 1500px;
      padding: 1em;
      background-color: #e30095;
      color: #ffffff;
      text-align: center;

      display: none;
    }

    body.ready {
      background-color: #5ee35a;
    }

    body.ready .theBigItem {
      display: block;
    }
  </style>
</head>
<body class="theBody">

<section>
  <h1>iframe-ios-poc | content</h1>
  <p>This page is the content of the iframe in the index.html file.</p>
</section>

<section>
  <pre id="theOutput"></pre>
</section>

<div class="theBigItem">
  <h3>The Big Item</h3>
  <p>The parent div of this text is purposely wider than what we think the iphone viewport might be.</p>
</div>

<script type="text/javascript">
  var theBody = document.getElementsByClassName('theBody')[0],
      theOutput = document.getElementById('theOutput');

  function ready(fn) {
    if (document.readyState != 'loading') {
      fn();
    } else {
      document.addEventListener('DOMContentLoaded', fn);
    }
  }

  ready(function () {

    setTimeout(function () {
      theOutput.textContent = 'blah blah';

      setTimeout(function () {
        theOutput.textContent += "\n\n";

        setTimeout(function () {
          theOutput.textContent += "\tHELLO?";
        }, 750);
      }, 750);
    }, 1000);

    setTimeout(function () {
      if (window.parent) {
        // Send config JSON to parent (Habitat) for saving
        window.parent.postMessage({
          'type': 'size',
          'method': 'set',
          'payload': {"width": "100%", "height": "600px"}
        }, '*');
      }
    }, 250);
  });

  setTimeout(function () {
    (theBody.classList) ? theBody.classList.add('ready') : theBody.className += ' ready';
  }, 5000);

  window.addEventListener('message', function (evt) {
    var payload = evt.data;
    if (payload.type === 'data') {
      console.log('postMessage type data');
      console.dir(payload);
    } else if (payload.type === 'dataglobal') {
      console.log('postMessage type dataglobal');
      console.dir(payload);
    } else if (payload.type == 'orientationchange') {
      console.log('postMessage type orientationchange');
      console.dir(payload);
    }
  }, false);
</script>

</body>
</html>
